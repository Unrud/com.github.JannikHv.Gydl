{
  "app-id": "com.github.JannikHv.Gydl",
  "runtime": "org.gnome.Platform",
  "runtime-version": "3.24",
  "sdk": "org.gnome.Sdk",
  "command": "gydl",
  "finish-args": [
     "--socket=wayland",
     "--socket=x11",
     "--share=network",
     "--persist=."
  ],
  "modules": [
    {
      "name": "gydl",
      "buildsystem": "simple",
      "build-commands": [
        "install -m755 src/gydl.py /app/bin/gydl",
        "mkdir -p /app/share/applications",
        "cp src/gydl.desktop /app/share/applications/com.github.JannikHv.Gydl.desktop"
      ],
      "sources": [
        {
          "type": "git",
          "url": "https://github.com/JannikHv/gydl.git",
          "commit": "9122cad3d0a976316e59c749875328b2a8b6d596"
        },
        {
          "type": "shell",
          "commands": [
            "sed -i s:Exec=/usr/bin/gydl:Exec=/app/bin/gydl: src/gydl.desktop",
            "sed -i s:Icon=applications-multimedia:Icon=com.github.JannikHv.Gydl.svg: src/gydl.desktop"
          ]
        }
      ],
      "modules": [
        {
          "name": "lame",
          "cleanup": ["/include", "/lib/debug", "/share"],
          "config-opts": [
            "--enable-shared",
            "--disable-static"
          ],
          "sources": [{
            "type": "archive",
            "url": "https://downloads.sourceforge.net/lame/lame-3.99.5.tar.gz",
            "sha256": "24346b4158e4af3bd9f2e194bb23eb473c75fb7377011523353196b19b9a23ff"
          }]
        },
        {
          "name": "ffmpeg",
          "cleanup": [ "/include", "/lib/pkgconfig", "/share/ffmpeg/examples" ],
          "build-options" : {
            "arch" : {
              "i386" : {
                "config-opts" : [
                  "--arch=x86"
                ]
              },
              "arm" : {
                "config-opts" : [
                  "--arch=arm"
                ]
              }
            }
          },
          "config-opts": [
            "--enable-shared",
            "--disable-static",
            "--enable-gnutls",
            "--enable-libmp3lame",
            "--enable-libvorbis",
            "--disable-doc",
            "--disable-ffplay",
            "--disable-ffserver",
            "--disable-devices"
          ],
          "sources": [{
            "type": "archive",
            "url": "https://ffmpeg.org/releases/ffmpeg-3.3.2.tar.xz",
            "sha256": "1998de1ab32616cbf2ff86efc3f1f26e76805ec5dc51e24c041c79edd8262785"
          }]
        },
        {
          "name": "youtube-dl",
          "no-autogen": true,
          "cleanup": ["/etc", "/share", "/man"],
          "build-options": { "env": { "PREFIX": "/app" } },
          "sources": [{
            "type": "archive",
            "url": "https://github.com/rg3/youtube-dl/releases/download/2017.06.25/youtube-dl-2017.06.25.tar.gz",
            "sha256": "0531958d4dc10f0fae7960a4c8d08d17fe57acf79719a76387d765c382809f59"
          }]
        }
      ]
    }
  ]
}
